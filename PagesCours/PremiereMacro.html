<html lang="fr">
<head>
	<title>Premiere macro</title>
	<link rel="stylesheet" href="../Template1CSS.css">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<meta charset="utf-8"/>
	</head>

<body>

<div id="lateral">
	<!--Titre-->
	<div id="title">Programmation VBA pour Excel</div>
	
	<!--Tableau menu-->
	<table id="tabmenu">
		<tr><td><a href="../PagesDivers/Accueil.html" target="_top">Accueil</a></td></tr>
		<tr><td><a href="../PagesCours/SommaireCours.html" target="_top">Sommaire du cours</a></td></tr>
		<tr><td><a href="../Exercices/SommaireExo.html" target="_top">Sommaire des exercices</a></td></tr>
		<tr><td><a href="../PagesDivers/Resume.html" target="_blank">Résumé du cours</a></td></tr>
		<!--<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/exercice/exercice.php?cidReq=EXCELVBA" target="_top">Quizz</a></td></tr>-->
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/forum/index.php?cidReq=EXCELVBA" target="_top">Forum</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/compilatio/work.php?cidReq=EXCELVBA" target="_top">Travaux</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/courses/EXCELVBA/?id_session=0" target="_top">TICE</a></td></tr>
	</table>
	
	<!--l'image renvoie sur le site d'AgroParisTech-->
	<div class="paraImg" style="margin-top:50px;"><a href="http://www2.agroparistech.fr/" target="_blank"><img src="../images/APT.png" alt="AgroParisTech" style="max-width:90%;"/></a></div>
	
	<!--lien About + copyright-->
	<div id="About"><a href="../PagesDivers/About.html" target="_top">About</a></br>&copy;AgroParisTech</div> 
</div> <!-- fin de la barre latérale -->

<div id="cours">
<div class="coursh2">Chapitre 1 - Première macro, utilisation de l'enregistreur de macro</div>
	<div class="para">Un programme écrit en VBA est souvent appelé, par abus de langage, une macro. Dans un premier temps, une macro peut être créée en utilisant l'enregistreur de macros, qui ne nécessite aucune connaissance du langage VBA.</div>
	<div class="para">L'enregistreur de macro est un outil accessible notamment sous Excel et permettant d'écrire du code VBA à partir d'opérations effectuées manuellement dans le logiciel. A l'image d'une caméra, toute la séquence d'actions effectuées entre le début et la fin de l'enregistrement est traduite en instructions VBA et stockée dans une <div class="important" data-txt="Ensemble nommé d’instructions ne renvoyant pas de valeur.">procédure</div> VBA sans arguments, qui pourra être exécutée à nouveau à l'identique.</div> 
	<div class="para">L'enregistreur de macro sous Excel permet donc de générer facilement du code VBA et de découvrir les mots clés et syntaxes à employer pour écrire ensuite directement ses propres programmes.</div>
	<div class="Remark">Pour vérifier que l'outil développeur est bien activé, aller dans les options d'Excel. Dans l'onglet <span class="capital">STANDARD</span>, la case &laquo; Afficher l'onglet Développeur dans le ruban &raquo; doit être cochée, comme dans la vidéo ci-dessous.</div>
	
	<video controls>
			<source src="../Videos/AffichageOnglet.mp4">
			<source src="../Videos/AffichageOnglet.webm">
			<source src="../Videos/AffichageOnglet.ogv">		
		Erreur chargement video. Mettez à jour votre navigateur ou télécharger la vidéo sur TICE.
		</video>

	<div class="coursh3">Enregistrer une macro - Paramétrage de la macro</div>
		<div class="para">Cliquez sur le bouton <span class="capital">ENREGISTRER UNE MACRO </span>:</div>
		<div class="paraImg"><img src="../images/PremiereMacro/NewMacro2.png" alt="NewMacro" style="max-width:100%;"/></div>
		
		<div class="para">La fenêtre ci-dessous apparaît à l'écran et vous permet de paramétrer la macro qui va être créée c'est-à-dire :</div>
		<div style="height:294px; margin-top:10px;"><!-- une div de la hauteur de l'image pour pas que le texte d'en dessous remonte à côté de celle ci -->
			<img src="../images/PremiereMacro/ParametresMacro.PNG" alt="ParametreMacros" style="float:left; padding-right:10px; max-width:100%;"/>
			<li>de préciser son nom dans le champ : <span class="capital">Nom de la macro</span> ;</li>
			<li>d'y associer si besoin un raccourci clavier afin de faciliter son lancement futur : <span class="capital">Touche de raccourci</span> ;</li>
			<li>de préciser à quel classeur elle sera rattachée par l'intermédiaire du menu déroulant <span class="capital">Enregistrer la macro dans</span> ;</li>
			<li>et enfin d'y associer une note explicative <span class="capital">Description</span>. </li>
		</div> <!--fin de la div image-->
		<div class="para">	Le menu déroulant <span class="capital">Enregistrer la macro dans :</span> vous propose trois options : </div>
		<div class="list">	
			<li><u>Ce classeur</u>, qui permet d'enregistrer la macro dans le classeur actif ;</li>
			<li><u>Nouveau classeur</u>, qui permet d'enregistrer la macro dans un nouveau classeur ;</li>
			<li><u>Classeur de macros personnelles</u> : la macro est enregistrée dans un classeur spécial appelé <span class="function">PERSO.XLS</span>. Ce classeur est ouvert automatiquement lors du lancement d'Excel et ses macros sont disponibles dans tous les classeurs ouverts.</li>
		</div> <!-- fin de la liste-->
		<div class="Remark">Si vous souhaitez qu'une macro soit utilisable dans Excel quels que soient les classeurs ouverts, enregistrez la dans votre classeur de macros personnelles (liste déroulante <span class="capital">ENREGISTRER LA MACRO DANS</span>). Pour ce cours, nous ferons les enregistrements dans le classeur courant.</div> 

	<div class="coursh3">Lancement de l'enregistrement</div>
		<div class="para">Une fois votre macro paramétrée suivant votre besoin, cliquez sur le bouton OK. </div>
		<div class="para">L'enregistrement est alors lancé et dès lors, toutes les actions que vous faites dans Excel sont enregistrées, traduites en code VBA puis sauvegardées dans une procédure portant le nom que vous avez spécifié à l'étape précédente (<span class="function">Macro1</span> dans l'exemple précédent).</div>

	<div class="coursh3">Arrêt de l'enregistrement</div>
		<div class="para">Une fois que vous avez réalisé toutes les actions que vous souhaitiez enregistrer, l’arrêt de l’enregistrement se fait en cliquant sur le bouton <span class="capital">ARRET DE L'ENREGISTREMENT </span>.</div>
		<div class="paraImg"><img src="../images/PremiereMacro/arret_enregistrement.png" alt="StopMacros" style="max-width:100%;"/></div>
		<div class="Forbiden">N’oubliez pas d’arrêter l’enregistrement d’une macro ! Dans le cas contraire vos actions continueraient à être enregistrées et vous ne seriez pas en mesure de relancer cette macro.</div>
		<div class="Warning">Pour sauvegarder votre classeur Excel et votre macro, le fichier doit être enregistré dans un format compatible avec la prise en compte des macros. Lorsque vous enregistrez votre fichier, sélectionnez le type &laquo Classeur Excel (prenant en charge les macros) &raquo;.</div>

	<div class="coursh3">Modes de repérages des cellules</div> 	
		<div class="para">Il existe deux modes de repérage des cellules dans un programme VBA, le mode absolu et le mode relatif.</div>
		<div class="para">Dans l’exercice précédent, vous avez utilisé le mode absolu c'est-à-dire que quel que soit l’état de votre système au moment où vous lancez votre macro, les textes seront toujours écrits dans les mêmes cellules (positionnement absolu).</div>
		<div class="para"> Dans certains cas, il est utile que le placement des actions de la macro soit déterminé de manière relative par rapport aux actions précédentes. On veut, par exemple, qu’une action soit faite toujours 2 cellules en dessous de celle sélectionnée à ce moment-là. Le positionnement est donc relatif à la cellule sélectionnée précédemment.</div>
		<div class="para">Le bouton ci-dessous permet de faire un choix entre ces deux modes de repérage. Ce choix dépend, bien entendu, des propriétés attendues de la macro que l’on est en train d’enregistrer.</div>
		<div class="paraImg"><img src="../images/PremiereMacro/reperage.png" alt="reperage" style="max-width:100%;"/></div>
		<div class="Remark">Vous pouvez passer d'un mode de repérage à l'autre avant et pendant l'enregistrement d'une macro.</div>
		<div class="Forbiden">Vérifiez toujours le mode dans lequel vous vous trouvez au lancement de l’enregistrement et avant d’effectuer la moindre action sans quoi votre macro pourrait avoir un comportement différent de celui auquel vous vous attendiez car non enregistrée dans le mode adéquat.</div>

	<div class="coursh3">Exécuter une macro </div>
		<div class="para">Pour exécuter une macro déjà enregistrée, il faut ouvrir le gestionnaire des macros, en cliquant sur ce bouton :</div>
		<div class="paraImg"><img src="../images/PremiereMacro/ExecuterMacro1.png" alt="ExecuterMacro1" style="max-width:100%;"></div>
		<div class="para">La fenêtre présentée ci-dessous s’ouvre alors : </div>
		<div style="height:369px; margin-top:10px;"><!-- une div de la hauteur de l'image pour pas que le texte d'en dessous remonte à côté de celle ci -->
			<div class="para"><img src="../images/PremiereMacro/ExecuterMacro2.PNG" alt="ExecuterMacro2" style="float:left; padding-right:10px; max-width:100%;"></div>
			<div class="para" style="padding-top:50px;">Il faut sélectionner dans la liste la macro désirée et cliquer sur le bouton <span class="capital">EXECUTER</span>.</div>
			<div class="para">Dans cet exemple, seule la macro <span class="function">Macro1</span> est disponible.</div> 
			<div class="para">Le menu déroulant <span class="capital">Macros dans</span> vous permet de faire un tri dans les macros disponibles et de n’afficher, par exemple, que celles enregistrées dans votre classeur personnel.</div>
		</div> <!--fin de la div image-->
	<div class="para">L’enregistreur de macro permet de manière rapide et simple de créer des macros. Cependant une macro ainsi créée ne s’exécutera que sur un ensemble de cellules données et possèdera des fonctionnalités limitées. Pour pouvoir créer des macros propres à ses besoins, efficaces et interactives, la connaissance du langage VBA est nécessaire. Il sera présenté dans les chapitres suivants. </div>

	
	<div class="barre" style="margin:40px 0;"></div>
	<div class="para" style="margin-top:50px;">Ce chapitre est terminé, à vous de jouer ! &#139; <a href="../Exercices/ex_PremiereMacro.html" target = "_blanc" class="important">lien vers les exercices</a> &#155;</div>	
		
	<ul id="nav">		
		<li id="navPrevious" style="display:none;"><a href="#.html">&laquo;</a></li> <!--display:none; pour cacher le bouton car on est au premier chap-->
		<li id="navMenu"><a href="../PagesDivers/Accueil.html">&#8801;</a></li>
		<li id="navNext"><a href="EnvironnementVBE.html">&raquo;</a></li>
	</ul>	
	
	<script type="text/javascript" src="../infobulle.js"></script>
	
</div> <!--fin du cours-->

</body>
</html>