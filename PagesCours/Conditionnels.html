<html lang="fr">
<head>
	<title>Conditionnels</title>
	<link rel="stylesheet" href="../Template1CSS.css">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<meta charset="utf-8"/>
	</head>

<body>

<div id="lateral">
	<!--Titre-->
	<div id="title">Programmation VBA pour Excel</div>
	
	<!--Tableau menu-->
	<table id="tabmenu">
		<tr><td><a href="../PagesDivers/Accueil.html" target="_top">Accueil</a></td></tr>
		<tr><td><a href="../PagesCours/SommaireCours.html" target="_top">Sommaire du cours</a></td></tr>
		<tr><td><a href="../Exercices/SommaireExo.html" target="_top">Sommaire des exercices</a></td></tr>
		<tr><td><a href="../PagesDivers/Resume.html" target="_blank">Résumé du cours</a></td></tr>
		<!--<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/exercice/exercice.php?cidReq=EXCELVBA" target="_top">Quizz</a></td></tr>-->
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/forum/index.php?cidReq=EXCELVBA" target="_top">Forum</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/compilatio/work.php?cidReq=EXCELVBA" target="_top">Travaux</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/courses/EXCELVBA/?id_session=0" target="_top">TICE</a></td></tr>
	</table>
	
	<!--l'image renvoie sur le site d'AgroParisTech-->
	<div class="paraImg" style="margin-top:50px;"><a href="http://www2.agroparistech.fr/" target="_blank"><img src="../images/APT.png" alt="AgroParisTech" style="max-width:90%;"/></a></div>
	
	<!--lien About + copyright-->
	<div id="About"><a href="../PagesDivers/About.html" target="_top">About</a></br>&copy;AgroParisTech</div> 
</div> <!-- fin de la barre latérale -->

<div id="cours">
	<div class="coursh2">Chapitre 5 - Prendre en compte des conditions</div>
		<div class="para">Fréquemment dans un programme on souhaite que certaines tâches (instructions) soient réalisées dans certains cas et pas dans d’autres. Ceci se traduit en VBA par l’intermédiaire des mots clés <span class="function">If... Then ...</span>, <span class="function">ElseIf... Then... </span> et <span class="function">Else...</span>.</div>
		<div class="para"><span style="text-decoration:underline;">Syntaxe</span> :</div>
		<div class="codeExample">
			<p><span class="keyWord">If</span> condition <span class="keyWord">Then</span></p>
			<p style="padding-left:20px;">Instructions_si_vrai</p>
			<p>	[<span class="keyWord">Else</span> </p>
			<p style="padding-left:20px;">Instructions_si_faux]</p>
			<p class="keyWord">End If</p>
		</div> <!--fin de l'exemple-->
		<div class="Forbiden">Dans une structure de bloc <span class="function">If</span>, il faut impérativement aller à la ligne après le <span class="function">Then</span>.</div>
		<div class="para">Lorsque le bloc <span class="function">If</span> contient une ou plusieurs sections <span class="function">ElseIf</span>, les différentes conditions sont testées jusqu’à ce qu’une soit vérifiée. Si aucune condition ne renvoie <span class="function">True</span>, les instructions de la section <span class="function">Else</span>, si elle existe, sont exécutées. Si aucune condition n’est vérifiée et si la section <span class="function">Else</span> n’existe pas, le bloc <span class="function">If</span> ne fait rien.</div>
		<div class="para"><span style="text-decoration:underline;">Syntaxe</span> :</div>
		<div class="codeExample">
			<p><span class="keyWord">If</span> condition_1 <span class="keyWord">Then</span></p>
			<p style="padding-left:20px;">Instructions_1</p>
			<p><span class="keyWord">ElseIf</span> condition_2 <span class="keyWord">Then</span></p>
			<p style="padding-left:20px;">Instructions_2</p>
			<p><span class="keyWord">ElseIf</span> condition_3 <span class="keyWord">Then</span></p>
			<p style="padding-left:20px;">Instructions_3</p>
			<p style="padding-left:20px;">...</p>
			<p class="keyWord">Else</p>
			<p style="padding-left:20px;">Instructions_n</p>
			<p class="keyWord">End If</p>
		</div> <!--fin de l'exemple-->
		<div class="para">VBA offre la possibilité d’utiliser les opérateurs logiques suivants : </div>
		<div class="list">
			<li>condition1 <span class="function">Or</span> condition2 : renvoie <span class="function">True</span> si l'une des deux conditions au moins est vérifiée ;
			<li>condition 1 <span class="function">Xor</span> condition2 : renvoie <span class="function">True</span> si une et une seule des deux conditions est vérifiée ;
			<li>condition 1 <span class="function">And</span> condition2 : renvoie <span class="function">True</span> si les deux conditions sont vérifiées; 
			<li><span class="function">Not</span> condition1 : renvoie <span class="function">True</span> si la condition n'est pas vérifiée.
		</div> <!--fin de la liste-->
		<div class="para"><span style="text-decoration:underline;">Exemple</span> :</div>
		<div class="codeExample">
			<p><span class="keyWord">Sub BonjourHeureIf()
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> heure <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> mes <span class="keyWord">As</span> String</p>
			<!--??? Essaie de mettre les commentaires en vert comme dans VBE ???-->
			<p style="padding-left:20px;">heure = Left(Time, 2) <span class="comment">'récupération de l'heure (2 caractères à 'gauche de la valeur de retour de la fonction Time</span></p>
			<p style="padding-left:20px;"><span class="keyWord">If</span> heure > 7 <span class="keyWord">And</span> heure < 12 <span class="keyWord">Then</span></p>
			<p style="padding-left:40px;">mes = "Bonjour"</p>
			<p style="padding-left:20px;"><span class="keyWord">ElseIf</span> heure >= 12 <span class="keyWord">And</span> heure < 18 <span class="keyWord">Then</span></p>
			<p style="padding-left:40px;">mes = "Bon après-midi"</p>
			<p style="padding-left:20px;"><span class="keyWord">ElseIf</span> heure >= 18 <span class="keyWord">And</span> heure < 22 <span class="keyWord">Then</span></p>
			<p style="padding-left:40px;">mes = "Bonne soirée"</p>
			<p style="padding-left:20px;" class="keyWord">Else</p>
			<p style="padding-left:40px;">mes = "Bonne nuit"</p>
			<p style="padding-left:20px;" class="keyWord">End If</p>
			<p style="padding-left:20px;">Range("A1").Value = mes</p>
			<p class="keyWord">End Sub</p>
		</div> <!--fin de l'exemple-->
	
	
	<div class="barre" style="margin:40px 0;"></div>
	<div class="para" style="margin-top:50px;">Ce chapitre est terminé, à vous de jouer ! &#139; <a href="../Exercices/ex_Conditionnels.html" target = "_blanc" class="important">lien vers les exercices</a> &#155;</div>
		
	<ul id="nav">		
		<li id="navPrevious"><a href="Variables.html">&laquo;</a></li>
		<li id="navMenu"><a href="../PagesDivers/Accueil.html">&#8801;</a></li>
		<li id="navNext"><a href="Boucles.html">&raquo;</a></li>
	</ul>		
		
</div> <!-- fin du cours -->
</body>
</html>