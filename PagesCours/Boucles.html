<html lang="fr">
<head>
	<title>Boucles</title>
	<link rel="stylesheet" href="../Template1CSS.css">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<meta charset="utf-8"/>
	</head>

<body>

<div id="lateral">
	<!--Titre-->
	<div id="title">Programmation VBA pour Excel</div>
	
	<!--Tableau menu-->
	<table id="tabmenu">
		<tr><td><a href="../PagesDivers/Accueil.html" target="_top">Accueil</a></td></tr>
		<tr><td><a href="../PagesCours/SommaireCours.html" target="_top">Sommaire du cours</a></td></tr>
		<tr><td><a href="../Exercices/SommaireExo.html" target="_top">Sommaire des exercices</a></td></tr>
		<tr><td><a href="../PagesDivers/Resume.html" target="_blank">Résumé du cours</a></td></tr>
		<!--<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/exercice/exercice.php?cidReq=EXCELVBA" target="_top">Quizz</a></td></tr>-->
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/forum/index.php?cidReq=EXCELVBA" target="_top">Forum</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/compilatio/work.php?cidReq=EXCELVBA" target="_top">Travaux</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/courses/EXCELVBA/?id_session=0" target="_top">TICE</a></td></tr>
	</table>
	
	<!--l'image renvoie sur le site d'AgroParisTech-->
	<div class="paraImg" style="margin-top:50px;"><a href="http://www2.agroparistech.fr/" target="_blank"><img src="../images/APT.png" alt="AgroParisTech" style="max-width:90%;"/></a></div>
	
	<!--lien About + copyright-->
	<div id="About"><a href="../PagesDivers/About.html" target="_top">About</a></br>&copy;AgroParisTech</div> 
</div> <!-- fin de la barre latérale -->

<div id="cours">

	<div class="coursh2">Chapitre 6 - Répéter les mêmes actions - Les boucles</div>
	<div class="para">VBA fournit deux structures pour répéter en boucle les mêmes instructions : l’instruction <span class="function">Do...Loop</span> et l’instruction <span class="function">For...Next</span>.</div>
	
	<div class="coursh3">La boucle Do...Loop</div>
		<div class="para">La boucle <span class="function">Do...Loop</span> est utilisée lorsque l’on veut que la répétition des instructions s’arrête quand une condition donnée est vérifiée. On distingue plusieurs syntaxes possibles.</div>
		<div class="codeExample">
			<p><span class="keyWord">Do While</span> condition <span class="comment">'Tant que la condition est vraie, les instructions sont exécutées</span></p>
			<p style="padding-left:20px;">Instructions</p>
			<p class="keyWord">Loop</p>
		</div> <!--fin de l'exemple-->
		<div class="codeExample">
			<p><span class="keyWord">Do Until</span> condition <span class="comment">'Jusqu'à ce que la condition devienne vraie, les instructions sont exécutées</span></p>
			<p style="padding-left:20px;">Instructions</p>
			<p class="keyWord">Loop</p>
		</div> <!--fin de l'exemple-->
		<div class="para">Avec ces deux boucles, les instructions peuvent ne jamais être exécutées. Pour qu’elles soient exécutées au moins une fois, on peut utiliser l’une des deux syntaxes suivantes :</div>
		<div class="codeExample">
			<p><span class="keyWord">Do</span> <span class="comment">'les instructions sont exécutées tant que la condition reste vraie</span></p>
			<p style="padding-left:20px;">Instructions</p>
			<p><span class="keyWord">Loop While</span> condition</p>
		</div> <!--fin de l'exemple-->
		<div class="codeExample">
			<p><span class="keyWord">Do</span> <span class="comment">'les instructions sont exécutées jusqu’à ce que la condition devienne vraie</span></p>
			<p style="padding-left:20px;">Instructions</p>
			<p><span class="keyWord">Loop Until</span> condition</p>
		</div> <!--fin de l'exemple-->
	
	<div class="coursh3">La boucle For...Next</div>
		<div class="para">La boucle <span class="funfction">For...Next</span> est utilisée lorsque l’on connait à l’avance le nombre de fois où l’on veut que les instructions soient répétées.</div>
		<div class="codeExample">
			<p><span class="keyWord">For</span> compteur = nbdébut <span class="keyWord">To</span> nbfin [Step nbpas]</p>
			<p style="padding-left:20px;">Instructions <span class="comment">'instructions exécutées un nombre déterminé de fois</span></p>
			<p><span class="keyWord">Next</span> compteur</p>
		</div> <!--fin de l'exemple-->
		<div class="para">Les instructions de la boucle <span class="function">For...Next</span> sont exécutées un nombre déterminé de fois. Lorsque l’option <span class="function">Step</span> n’est pas renseignée, le compteur est incrémenté de 1 à chaque itération et les instructions sont exécutées nbdébut - nbfin fois.</span>
		<div class="para"><span style="text-decoration:underline;">Exemple</span> :</div>
		<div class="para">La procédure suivante calcule la somme des n premiers entiers :</div>
		<div class="codeExample">
			<p><span class="keyWord">Sub</span> SommeEntiers()</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> somme <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> compteur <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> n <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;">n = Range("A1").Value</p>
			<p style="padding-left:20px;"><span class="keyWord">For</span> compteur = 1 <span class="keyWord">To</span> n</p>
			<p style="padding-left:40px;">somme = somme + compteur</p>
			<p style="padding-left:20px;"><span class="keyWord">Next</span> compteur</p>
			<p style="padding-left:20px;">Range("A2").Value = "Somme des " & n & " premiers entiers : "</p>
			<p style="padding-left:20px;">Range("B2").Value = somme</p>
			<p class="keyWord">End Sub</p>
		</div> <!--fin de l'exemple-->
		<div class="Remark">Le compteur peut être, à chaque itération, incrémenté d'un pas choisi.</div>
		<div class="para"><span style="text-decoration:underline;">Exemple</span> :</div>
		<!--??? Expliquer ce code par une ou deux phrases???-->
		<div class="codeExample">
			<p><span class="keyWord">For</span> compteur = 21 <span class="keyWord">To</span> 1 <span class="keyWord">Step</span> -2</p>
			<p style="padding-left:20px;">Range("A"&compteur).Value = compteur – 1
			<p><span class="keyWord">Next</span> compteur
		</div> <!--fin de l'exemple-->
		
	<div class="coursh3">La boucle For Each…Next</div>
	<!--??? Expliquer le code de cette procédure avec une ou deux phrases???-->
		<div class="para">La boucle <span class="function">For Each…Next</span> permet d’accéder aux objets d’une collection.</div>
		<div class="para"><span style="text-decoration:underline;">Exemple</span> :</div>
		<div class="codeExample">
			<p>Sub ColorieCellule()</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> MaPlage <span class="keyWord">As</span> Range</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> Cellule <span class="keyWord">As</span> Range</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> i <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">Set</span> MaPlage = Range("A1:B5")</p>
			<p style="padding-left:20px;"><span class="keyWord">For Each</span> Cellule <span class="keyWord">In</span> MaPlage</p>
			<p style="padding-left:20px;">Cellule.Interior.ColorIndex = i	</p>
			<p style="padding-left:20px;">i = i + 1</p>
			<p style="padding-left:20px;"><span class="keyWord">Next</span> Cellule</p>
			<p class="keyWord">End Sub</p>
		</div> <!--fin de l'exemple-->
	
	<div class="coursh3">Interrompre une boucle</div>
		<div class="para">L’instruction <span class="keyWordP">Exit</span> permet de quitter un bloc <span class="function">Do…Loop</span>, <span class="function">For…Next</span>, <span class="function">Function</span>, ou <span class="function">Sub</span>. Sa syntaxe est la suivante : <span class="function">Exit</span> + <span class="function">mot_clé_début_de_bloc</span></div>
		<div class="para"><span style="text-decoration:underline;">Exemples</span> :</div>
		<li>Exit Do, Exit For, Exit Function, Exit Sub ;</li>
		<li>La boucle suivante s’arrête lorsque la réponse Rep est n ou N :</li>
		<div class="codeExample">
			<p class="keyWord">Do</p>
			<p style="padding-left:20px;">Rep = InputBox("Voulez-vous continuer ? (O/N)")</p>
			<p style="padding-left:20px;"><span class="keyWord">If</span> Lcase(rep) = "n" <span class="keyWord">Then Exit Do</span></p>
			<p class="keyWord">Loop</p>
		</div> <!--fin de l'exemple-->
	<div class="Remark">La fonction <span class="function">InputBox</span> permet de créer une boîte de dialogue. Pour plus d’informations à ce sujet, reportez-vous au chapitre « <a href="../PagesCours/EntreesSorties.html">Les entrées et sorties standards</a> ».</div>

	
	<div class="barre" style="margin:40px 0;"></div>
	<div class="para" style="margin-top:50px;">A vous de jouer ! &#139; <a href="../Exercices/ex_Boucles.html" target = "_blanc" class="important">lien vers les exercices</a> &#155;</div>
	
	<ul id="nav">		
		<li id="navPrevious"><a href="Conditionnels.html">&laquo;</a></li>
		<li id="navMenu"><a href="../PagesDivers/Accueil.html">&#8801;</a></li>
		<li id="navNext"><a href="Fonctions.html">&raquo;</a></li>
	</ul>		
		
</div> <!-- fin du cours -->
</body>
</html>