<html lang="fr">
<head>
	<title>Exercices chap 8</title>
	<link rel="stylesheet" href="../Template1CSS.css">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<meta charset="utf-8"/>
	</head>

<body>

<div id="lateral">
	<!--Titre-->
	<div id="title">Programmation VBA pour Excel</div>
	
	<!--Tableau menu-->
	<table id="tabmenu">
		<tr><td><a href="../PagesDivers/Accueil.html" target="_top">Accueil</a></td></tr>
		<tr><td><a href="../PagesCours/SommaireCours.html" target="_top">Sommaire du cours</a></td></tr>
		<tr><td><a href="../Exercices/SommaireExo.html" target="_top">Sommaire des exercices</a></td></tr>
		<tr><td><a href="../PagesDivers/Resume.html" target="_blank">Résumé du cours</a></td></tr>
		<!--<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/exercice/exercice.php?cidReq=EXCELVBA" target="_top">Quizz</a></td></tr>-->
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/forum/index.php?cidReq=EXCELVBA" target="_top">Forum</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/compilatio/work.php?cidReq=EXCELVBA" target="_top">Travaux</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/courses/EXCELVBA/?id_session=0" target="_top">TICE</a></td></tr>
	</table>
	
	<!--l'image renvoie sur le site d'AgroParisTech-->
	<div class="paraImg" style="margin-top:50px;"><a href="http://www2.agroparistech.fr/" target="_blank"><img src="../images/APT.png" alt="AgroParisTech" style="max-width:90%;"/></a></div>
	
	<!--lien About + copyright-->
	<div id="About"><a href="../PagesDivers/About.html" target="_top">About</a></br>&copy;AgroParisTech</div> 
</div> <!-- fin de la barre latérale -->

<div id="cours">
	<div class="coursh2">Les tableaux</div>
	<div class="coursh2">Exercices</div>
	
<div class="coursh3" id="exo1">Exercice 1</div>
		<!--énoncé-->
		<div class="para">Ecrire la fonction <span class="function">verifierJours(Jour As String)</span> qui permet de vérifier que la chaîne de caractères passée en argument est bien un jour de la semaine et qui renvoie un booléen, et la tester dans Excel.</div>
		<div class="exoButton">
			<div class="showhelp"><a href="#exo1Help" class="showHelpA">Un indice ?</a></div>	
			<div class="showCorrection"><a href="#exo1correct" class="showCorrectionA">Voir la correction</a></div>	
		</div>
		
		<!--aide-->
		<div class="exHelp" id="exo1Help">
		<div class="para">Il faut écrire un tableau contenant tous les jours de la semaine et vérifier si le mot entré en argument fait partie de cette liste, avec une boucle.</div>
		<p><a href="#exo1" class="showHelpA">Hide</a></p></div>
		
		<!--correction-->
		<div class="exCorrection" id="exo1correct">
		<div class="codeExample">
			<p><span class="keyWord">Function</span> verifie_jour(jour <span class="keyWord">As</span> String) <span class="keyWord">As</span> Boolean</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> week <span class="keyWord">As</span> Variant</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> i <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;">verifie_jour = <span class="keyWord">False</span></p>
			<p style="padding-left:20px;">week = Array("monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday")</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> top <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;">top = UBound(week) - 1</p>
			<p style="padding-left:20px;"><span class="keyWord">For</span> i = 1 <span class="keyWord">To</span> top</p>
			<p style="padding-left:40px;"><span class="keyWord">If</span> jour = week(i) <span class="keyWord">Then</span></p>
			<p style="padding-left:60px;">verifie_jour = <span class="keyWord">True</span></p>
			<p style="padding-left:40px;" class="keyWord">End If</p>
			<p style="padding-left:20px;"><span class="keyWord">Next</span> i</p>
			<p class="keyWord">End Function</p>
		</div>
		<p><a href="#exo1" class="showCorrectionA">Hide</a></p></div>
	<!--fin de l'ex1-->
	
		
	<div class="coursh3" id="exo2">Exercice 2 (facultatif car difficile)</div>
		<!--énoncé-->
		<div class="para">Etant donné une liste d'en-têtes pour les lignes et une liste d'en-têtes pour les colonnes, écrire un programme (des procédures et/ou des fonctions) permettant leur mise en page sur la première ligne et sur la première colonne.</div>
		<div class="paraImg"><img src="../images/Exercices/exo2Chap8.png" alt="exo2chap8" style="max-width:100%;"/></div>
		<div class="exoButton">
			<div class="showhelp"><a href="#exo2Help" class="showHelpA">Un indice ?</a></div>	
			<div class="showCorrection"><a href="#exo2correct" class="showCorrectionA">Voir la correction</a></div>	
		</div>
		
		<!--aide-->
		<div class="exHelp" id="exo2Help">
		<div class="para">Il faut écrire deux procédures :</div>
		<div class="list">
			<li>une avec les deux listes en arguments qui affecte les en-têtes aux cellules correspondantes ;</li>
			<li>une autre qui renseigne les deux listes et qui appelle la procédure précédente. </li>
		</div>
		<div class="para">Dans la première procédure, il faut deux boucles qui parcourent chacune des listes pour affecter chaque valeurs (chaque en-tête) à une cellules.</div>
		<div class="para"><span class="function">Range</span> demande en argument les coordonnées d'une cellule avec la notation d'Excel (lettre + chiffre). Vous ne pouvez donc pas l'utiliser pour parcourir les colonnes (A+1 n'ayant aucun sens). Vous pouvez alors utiliser <span class="function">Cells(x, y)</span> : x étant l'index numérique de la ligne et y l'index numérique de la colonne.</div>
		<div class="para">Cet exercice est long et difficile, ne baissez pas les bras !</div>
		<p><a href="#exo2" class="showHelpA">Hide</a></p></div>
		
		<!--correction-->
		<div class="exCorrection" id="exo2correct">
		<div class="codeExample">
			<p><span class="keyWord">Sub</span> mise_en_page2(lignes <span class="keyWord">As</span> Variant, colonnes <span class="keyWord">As</span> Variant)</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> indexL <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> indexC <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;">indexL = <span class="keyWord">UBound</span>(lignes)</p>
			<p style="padding-left:20px;">indexC = <span class="keyWord">UBound</span>(colonnes)</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> i <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> j <span class="keyWord">As</span> Integer</p>
			<p style="padding-left:20px;"><span class="keyWord">For</span> i = 0 <span class="keyWord">To</span> indexL <span class="comment">'affectation des index des lignes</span></p>
			<p style="padding-left:40px;">Range("A" & (i + 2)).Value = lignes(i)</p>
			<p style="padding-left:20px;"><span class="keyWord">Next</span> i</p>
			<p style="padding-left:20px;">Range("A1").Select <span class="comment">'retour à la case départ</span></p>
			<p style="padding-left:20px;"><span class="keyWord">For</span> j = 0 <span class="keyWord">To</span> indexC <span class="comment">'affectation des index des colonnes</span></p>
			<p style="padding-left:40px;">Cells(1, (j+2)).Value = colonnes(j)</p>
			<p style="padding-left:20px;"><span class="keyWord">Next</span> j</p>
			<p class="keyWord">End Sub</p>

			<p class="comment">'=========='</p>
			
			<p><span class="keyWord">Sub</span> ligne_colonnes()</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> week <span class="keyWord">As</span> Variant</p>
			<p style="padding-left:20px;"><span class="keyWord">Dim</span> weather <span class="keyWord">As</span> Variant</p>
			<p style="padding-left:20px;">week = <span class="keyWord">Array</span>("lundi", "mardi", "mercredi", "jeudi", "vendredi", "samedi", "dimanche")</p>
			<p style="padding-left:20px;">weather = <span class="keyWord">Array</span>("soleil", "nuageux", "pluie", "orage")</p>
			<p style="padding-left:20px;"><span class="keyWord">Call</span> mise_en_page2(week, weather)</p>
			<p class="keyWord">End Sub</p>
		</div>
		<div class="para"><u>Rappel</u> : la fonction <span class="function">Ubound</span> donne l'index du dernier élément d'un tableau.</div>
		<div class="para">Dans la procédure <span class="function">mise_en_pages2</span>, les boucles <span class="function">For... Next</span> permettent de parcourir les tableaux <span class="function">lignes</span> et <span class="function">colonnes</span> et d'affecter les cellules correspondantes.</div>
		<div class="para">Vous avez dû remarquer que les coordonnées des cellules sont à i+2 et j+2. Cela est dû au fait que l'index du premier élément d'un tableau est 0 et que l'on commence à affecter les valeurs à partir de la deuxième cellule de la ligne ou de la colonne (la cellule A1 restant vierge).</div>
		<p><a href="#exo2" class="showCorrectionA">Hide</a></p></div>
	<!--fin de l'ex2-->	
	
	
	<div class="barre" style="margin:40px 0;"></div>
	<div class="para" style="text-align:center;">Félicitations, vous avez terminé les exercices de ce chapitre. </div>
	<div class="para">Vous pouvez passer au chapitre suivant en cliquant sur <a href="../PagesCours/Evenements.html" target="_top" class="important">ce lien</a> ou sur la flèche droite en dessous. Vous pouvez également retourner sur le chapitre en cours en cliquant sur la flèche gauche.</div>	
	
	<ul id="nav">		
		<li id="navPrevious"><a href="../PagesCours/Tableaux.html">&laquo;</a></li>
		<li id="navMenu"><a href="SommaireExo.html">&#8801;</a></li>
		<li id="navNext"><a href="../Pagescours/Evenements.html">&raquo;</a></li>
	</ul>		
		
</div> <!-- fin du cours -->
</body>
</html>