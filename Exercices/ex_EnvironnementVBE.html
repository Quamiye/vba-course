<html lang="fr">
<head>
	<title>Exercices chap 2</title>
	<link rel="stylesheet" href="../Template1CSS.css">
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<meta charset="utf-8"/>
	</head>

<body>

<div id="lateral">
	<!--Titre-->
	<div id="title">Programmation VBA pour Excel</div>
	
	<!--Tableau menu-->
	<table id="tabmenu">
		<tr><td><a href="../PagesDivers/Accueil.html" target="_top">Accueil</a></td></tr>
		<tr><td><a href="../PagesCours/SommaireCours.html" target="_top">Sommaire du cours</a></td></tr>
		<tr><td><a href="../Exercices/SommaireExo.html" target="_top">Sommaire des exercices</a></td></tr>
		<tr><td><a href="../PagesDivers/Resume.html" target="_blank">Résumé du cours</a></td></tr>
		<!--<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/exercice/exercice.php?cidReq=EXCELVBA" target="_top">Quizz</a></td></tr>-->
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/forum/index.php?cidReq=EXCELVBA" target="_top">Forum</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/main/compilatio/work.php?cidReq=EXCELVBA" target="_top">Travaux</a></td></tr>
		<tr><td><a href="https://tice.agroparistech.fr/coursenligne/courses/EXCELVBA/?id_session=0" target="_top">TICE</a></td></tr>
	</table>
	
	<!--l'image renvoie sur le site d'AgroParisTech-->
	<div class="paraImg" style="margin-top:50px;"><a href="http://www2.agroparistech.fr/" target="_blank"><img src="../images/APT.png" alt="AgroParisTech" style="max-width:90%;"/></a></div>
	
	<!--lien About + copyright-->
	<div id="About"><a href="../PagesDivers/About.html" target="_top">About</a></br>&copy;AgroParisTech</div> 
</div> <!-- fin de la barre latérale -->

<div id="cours">
	<div class="coursh2">L’environnement de développement Visual Basic Editor</div>
	<div class="coursh2">Exercices</div>

	<div class="coursh3" id="exo1">Exercice 1</div>
		<!--énoncé-->
		<div class="para">La macro <span class="function">macro_mise_en_page</span> qui vous avez enregistrée dans le <a href="ex_PremiereMacro.html#exo2" target="_blank">chapitre précédent (ex.2)</a> doit avoir à peu près le code suivant :</div>
		<div class="codeExample">
			<p><span class="keyWord">Sub<span class="keyWord"> macro_mise_en_page()</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Produits"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Quantités"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Total"</p>
			<p class="keyWord">End Sub</p>
		</div> <!-- fin de l'exemple-->
		<div class="para">L'instruction <span class="function">ActiveCell.Offset(1,0).Range("A1").Select</span> sélectionne (Select) une cellule (Range) qui est sur une ligne en dessous et sur la même colonne (<span class="function">Offset(déplacement_ligne, déplacement_colonne)</span>) que la cellule active (ActiveCell). L'instruction <span class="function">ActiveCell.Offset(1,0).Range("A1").Select</span> peut être remplacée par l’instruction <span class="function">ActiveCell.Offset(1,0).Select</span>.</div>
		<div class="para">Pour vous rendre compte de cela par vous-même, depuis l’éditeur VBA placez-vous sur la procédure <span class="function">macro_mise_en_page</span> et appuyez sur la touche F8. La première ligne de la macro est surlignée en jaune. Si vous appuyez à nouveau sur F8, celle-ci est exécutée. Vous pouvez alors voir dans le classeur quels en ont été les effets. En procédant de même pour toutes les instructions produites découvrir leurs sens.</div>
		<!--pas de correction-->
	<!--fin de l'ex1-->
	
	
	<div class="coursh3" id="exo2">Exercice 2</div>
		<!--énoncé-->
		<div class="para">Faire comme dans l’exercice précèdent pour tous les programmes enregistrés précédemment.</div>
		<!--pas de correction-->
	<!--fin de l'ex2-->
		
		
	<div class="coursh3" id="exo3">Exercice 3</div>
		<!--énoncé-->
		<div class="para">Modifier la macro <span class="function">macro_mise_en_page</span> (<i>cf</i>. <a href="ex_PremiereMacro.html#exo2" target="_blank">ex.2 chap.1</a>) pour que "Produit" soit écrit en caractères gras et italiques, dans la cellule qui se trouve dans la colonne de droite et sur la même ligne que la cellule active comme dans l'exemple ci-dessous.</div>
		<div class="paraImg"><img src="../images/Exercices/exo3Chap2.png" alt="exo3Chap2" style="max-width:100%;"></div>
		<div class="exoButton">
			<div class="showhelp"><a href="#exo3Help" class="showHelpA">Un indice ?</a></div>	
			<div class="showCorrection"><a href="#exo3correct" class="showCorrectionA">Voir la correction</a></div>	
		</div>
		
		<!--aide-->
		<div class="exHelp" id="exo3Help">
		<div class="para">Servez-vous de l'enregistreur de macro pour connaître les instructions corresponsantes.</div>
		<p><a href="#exo3" class="showHelpA">Hide</a></p></div>
		
		<!--correction-->
		<div class="exCorrection" id="exo3correct">
		<div class="codeExample">
			<p><span class="keyWord">Sub</span> macro_mise_en_pageModified1()</p>
			<p style="padding-left:20px;">ActiveCell.Offset(0, 1).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Produits"</p>
			<p style="padding-left:20px;">Selection.Font.Italic = <span class="keyWord">True</span></p>
			<p style="padding-left:20px;">Selection.Font.Bold = <span class="keyWord">True</span></p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Quantites"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Total"</p>
			<p class="keyWord">End Sub</p>
		</div>
		<p><a href="#exo3" class="showCorrectionA">Hide</a></p>
		</div>
	<!-- fin de l'ex3-->
	
		
	<div class="coursh3" id="exo4">Exercice 4</div>
		<!--énoncé-->
		<div class="para">Modifier la macro <span class="function">macro_mise_en_page</span> (<i>cf</i>. <a href="ex_PremiereMacro.html#exo2" target="_blank">ex.2 chap.1</a>) pour que "Remise" soit écrit en caractères gras et italiques, dans la cellule qui se trouve dans la colonne de droite et sur la ligne juste au-dessus de celle de la cellule où est écrit "Produits" comme dans l'exemple ci-dessous.</div>
		<div class="paraImg"><img src="../images/Exercices/exo4Chap2.png" alt="exo4Chap2" style="max-width:100%;"></div>
		<div class="exoButton">
			<div class="showhelp"><a href="#exo4Help" class="showHelpA">Un indice ?</a></div>	
			<div class="showCorrection"><a href="#exo4correct" class="showCorrectionA">Voir la correction</a></div>	
		</div>
		
		<!--aide-->
		<div class="exHelp" id="exo4Help">
		<div class="para">Servez-vous de l'enregistreur de macro pour connaître les instructions corresponsantes.</div>
		<p><a href="#exo4" class="showHelpA">Hide</a></p></div>
				
		<!--correction-->
		<div class="exCorrection" id="exo4correct">
		<div class="codeExample">
			<p><span class="keyWord">Sub</span> macro_mise_en_pageModified()</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Produits"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Quantites"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Total"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(-3, 1).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Remise"</p>
			<p style="padding-left:20px;">Selection.Font.Italic = <span class="keyWord">True</span></p>
			<p style="padding-left:20px;">Selection.Font.Bold = <span class="keyWord">True</span></p>
			<p class="keyWord">End Sub</p>
		</div>
		<p><a href="#exo4" class="showCorrectionA">Hide</a></p></div>
	<!--fin de l'ex4-->
	
		
	<div class="coursh3" id="exo5">Exercice 5</div>
		<!--énoncé-->
		<div class="para">Ecrire une nouvelle macro nommée <span class="function">macro_mep_absolue</span> qui réalise les mêmes instructions mais toujours à partir de la cellule A3.</div>
		<div class="exoButton">
			<div class="showhelp"><a href="#exo5Help" class="showHelpA">Un indice ?</a></div>	
			<div class="showCorrection"><a href="#exo5correct" class="showCorrectionA">Voir la correction</a></div>	
		</div>
		
		<!--aide-->
		<div class="exHelp" id="exo5Help">
		<div class="para"> Au début de la procédure, il faut sélectionner (<span class="function">.Select</span>) la cellule (<span class="function">Range</span>) A3 en tant que la cellule active.</div>
		<p><a href="#exo5" class="showHelpA">Hide</a></p></div>
			
		<!--correction-->
		<div class="exCorrection" id="exo5correct">
		<div class="codeExample">
			<p><span class="keyWord">Sub</span> macro_mep_absolue()</p>
			<p style="padding-left:20px;">Range("A3").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Produits"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Quantites"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(1, 0).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Total"</p>
			<p style="padding-left:20px;">ActiveCell.Offset(-3, 1).Range("A1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "Remise"</p>
			<p style="padding-left:20px;">Selection.Font.Italic = <span class="keyWord">True</span></p>
			<p style="padding-left:20px;">Selection.Font.Bold = <span class="keyWord">True</span></p>
			<p class="keyWord">End Sub</p>
		</div>
		<p><a href="#exo5" class="showCorrectionA">Hide</a></p></div>
	<!--fin de l'ex5-->

		
	<div class="coursh3" id="exo6">Exercice 6</div>
		<!--énoncé-->
		<div class="para">Ecrire une macro <span class="function">macro_cout</span> qui permet de calculer le coût d’un achat (quantité*prix_unitaire) à partir des valeurs contenues dans les cellules A1 et B1 de la feuille courante. Le résultat sera écrit dans la cellule C1.</div>
		<div class="exoButton">
			<div class="showhelp"><a href="#exo6Help" class="showHelpA">Un indice ?</a></div>	
			<div class="showCorrection"><a href="#exo6correct" class="showCorrectionA">Voir la correction</a></div>	
		</div>
		
		<!--aide-->
		<div class="exHelp" id="exo6Help">
		<div class="para">Il faut d'abord sélectionner la cellule C1 puis y insérer le calcul.</div>
		<p><a href="#exo6" class="showHelpA">Hide</a></p></div>
			
		<!--correction-->
		<div class="exCorrection" id="exo6correct">
		<div class="codeExample">
			<p><span class="keyWord">Sub</span> macro_cout()</p>
			<p style="padding-left:20px;">Range("C1").Select</p>
			<p style="padding-left:20px;">ActiveCell.FormulaR1C1 = "= RC[-2] * RC[-1]"</p>
			<p class="keyWord">End Sub</span>
		</div>
		<p><a href="#exo6" class="showCorrectionA">Hide</a></p></div>
	<!--fin de l'ex6-->

	
	<div class="barre" style="margin:40px 0;"></div>
	<div class="para" style="text-align:center;">Félicitations, vous avez terminé les exercices de ce chapitre. </div>
	<div class="para">Vous pouvez passer au chapitre suivant en cliquant sur <a href="../PagesCours/AccesFonctionnalites.html" target="_top" class="important">ce lien</a> ou sur la flèche droite en dessous. Vous pouvez également retourner sur le chapitre en cours en cliquant sur la flèche gauche.</div>	
	
	<ul id="nav">		
		<li id="navPrevious"><a href="../PagesCours/EnvironnementVBE.html">&laquo;</a></li>
		<li id="navMenu"><a href="SommaireExo.html">&#8801;</a></li>
		<li id="navNext"><a href="../PagesCours/AccesFonctionnalites.html">&raquo;</a></li>
	</ul>		
		
</div> <!-- fin du cours -->
</body>
</html>